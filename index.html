<!DOCTYPE html>
<html lang="pt-br">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plano de Express√£o Cabal√≠stico</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#111827">

<style>
body{font-family:Arial;padding:30px;background:#f4f4f4}
input,button{padding:10px;margin:5px}
.card{background:#fff;padding:20px;margin-top:20px;border-radius:10px}
table{border-collapse:collapse;width:100%;margin-top:15px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
.vermelho{color:#c0392b}
.azul{color:#2980b9}
.verde{color:#27ae60}
.amarelo{color:#f1c40f}

.bloco-momento{
  margin-top:60px;
  padding:30px;
  background:#111827;
  color:white;
  border-radius:10px;
}
.bar-bg{background:#2a2a2a;height:18px;border-radius:10px;margin:8px 0;}
.bar{height:100%;width:0%;border-radius:10px;transition:1s;}
.fisico{background:#ff4d4d;}
.mental{background:#4da6ff;}
.emocional{background:#33cc66;}
.intuitivo{background:#ffd633;}
.criativo { background: #a855f7; } 
.indeciso { background: #f97316; } 
.neutro { background: #94a3b8; }  
.resumoMomento{margin-top:25px;padding:20px;background:#1f2937;border-radius:8px;}
/* Esconde o texto que fica abaixo das barras */
#txtFisicoNat, #txtMentalNat, #txtEmocionalNat, #txtIntuitivoNat,
#txtFisico, #txtMental, #txtEmocional, #txtIntuitivo {
    display: none;
}
input {
  width: 600px;
  font-size: 18px;
  padding: 14px;
  background-color: #e5e7eb; /* Cor cinza id√™ntica ao padr√£o do sistema */
  border: 1px solid #ccc;    /* Borda suave para dar profundidade */
  color: #333;               /* Cor do texto ao digitar */
  display: block;            /* Garante que fiquem um abaixo do outro */
  margin: 10px auto;         /* Centraliza e d√° espa√ßamento */
}
  
/* MOBILE */
@media (max-width:768px){
  body{padding:15px;}
  h1{font-size:28px;}
  input,button,select{width:100%;box-sizing:border-box;margin:8px 0;}
  .bloco-momento{padding:20px;margin-top:30px;}
}

 /* Isso for√ßa os campos a aparecerem e ficarem empilhados no celular */
@media (max-width: 768px) {
    .container-inputs { /* Use a classe que envolve seus inputs */
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    input, select {
        display: block !important; /* For√ßa a exibi√ß√£o */
        width: 90% !important;     /* Ajusta a largura para o celular */
        margin-bottom: 25px;      /* D√° um espa√ßo entre o nome e a data */
    }
} 
</style>

</head>
<body>



<h1>Plano de Express√£o Qu√¢ntico</h1>

Nome Completo (igual certid√£o)<input id="nome" placeholder="">
            Data de Nascimento<input type="date" id="dataNascimento" required data-placeholder="Data de Nascimento">
                 

  
<button onclick="gerarTudo()">GERAR MAPA</button>
<button onclick="exportarRelatorio()">GERAR RELAT√ìRIO PDF</button>

<div id="natural" class="card"></div>
<div id="momento" style="display:none"></div>
<section class="bloco-momento" id="blocoNatural">
<h2>PLANO NATURAL</h2>

<div>
F√≠sico: <span id="numFisicoNat"></span><div class="bar-bg"><div id="barFisicoNat" class="bar fisico"></div></div><p id="txtFisicoNat"></p>
Mental: <span id="numMentalNat"></span><div class="bar-bg"><div id="barMentalNat" class="bar mental"></div></div><p id="txtMentalNat"></p>
Emocional: <span id="numEmocionalNat"></span><div class="bar-bg"><div id="barEmocionalNat" class="bar emocional"></div></div><p id="txtEmocionalNat"></p>
Intuitivo: <span id="numIntuitivoNat"></span><div class="bar-bg"><div id="barIntuitivoNat" class="bar intuitivo"></div></div><p id="txtIntuitivoNat"></p>
<hr style="border: 0; border-top: 1px solid #374151; margin: 20px 0;">
Criativo: <span id="numCriativoNat"></span><div class="bar-bg"><div id="barCriativoNat" class="bar criativo"></div></div>
Indeciso: <span id="numIndecisoNat"></span><div class="bar-bg"><div id="barIndecisoNat" class="bar indeciso"></div></div>
Neutro: <span id="numNeutroNat"></span><div class="bar-bg"><div id="barNeutroNat" class="bar neutro"></div></div> 
<div id="resumoExpressaoNat" class="resumoMomento" style="margin-top:10px; border-left: 4px solid #a855f7;"></div>  
</div>

<div id="resumoNatural" class="resumoMomento"></div>
</section>
<section class="bloco-momento">
<h2>STATUS DO MOMENTO</h2>

<select id="anoSelect"></select>
<button onclick="gerarStatusMomento()">Gerar Status</button>

<div>
F√≠sico: <span id="numFisico"></span><div class="bar-bg"><div id="barFisico" class="bar fisico"></div></div><p id="txtFisico"></p>
Mental: <span id="numMental"></span><div class="bar-bg"><div id="barMental" class="bar mental"></div></div><p id="txtMental"></p>
Emocional: <span id="numEmocional"></span><div class="bar-bg"><div id="barEmocional" class="bar emocional"></div></div><p id="txtEmocional"></p>
Intuitivo: <span id="numIntuitivo"></span><div class="bar-bg"><div id="barIntuitivo" class="bar intuitivo"></div></div><p id="txtIntuitivo"></p>
<hr style="border: 0; border-top: 1px solid #374151; margin: 20px 0;">
Criativo: <span id="numCriativoMom"></span><div class="bar-bg"><div id="barCriativoMom" class="bar criativo"></div></div>
Indeciso: <span id="numIndecisoMom"></span><div class="bar-bg"><div id="barIndecisoMom" class="bar indeciso"></div></div>
Neutro: <span id="numNeutroMom"></span><div class="bar-bg"><div id="barNeutroMom" class="bar neutro"></div></div>
<div id="resumoExpressaoMom" class="resumoMomento" style="margin-top:10px; border-left: 4px solid #a855f7;"></div>  
</div>

<div id="resumoMomento" class="resumoMomento"></div>
</section>
<script src="textos.js"></script>
<script>
//================ TABELA CABAL√çSTICA
//================ CONFIGURA√á√ÉO E TABELAS
const tabela = { A:1, J:1, I:1, Q:1, Y:1, B:2, K:2, R:2, C:3, G:3, L:3, S:3, D:4, M:4, T:4, E:5, H:5, N:5, U:6, V:6, W:6, X:6, √á:6, O:7, Z:7, F:8, P:8 };

const tabelaExpressao = {
    'E':'criativo','W':'indeciso','D':'neutro','M':'neutro',
    'A':'criativo','H':'indeciso','J':'indeciso','N':'indeciso','P':'indeciso','G':'neutro','L':'neutro',
    'I':'criativo','O':'criativo','R':'criativo','Z':'criativo','B':'indeciso','S':'indeciso','T':'indeciso','X':'indeciso',
    'K':'criativo','F':'indeciso','Q':'indeciso','U':'indeciso','Y':'indeciso','C':'neutro','V':'neutro'
};

const planos = { fisico: ["E","W","D","M"], mental: ["A","H","J","N","P","G","L"], emocional: ["I","O","R","Z","B","S","T","X"], intuitivo: ["K","F","Q","U","Y","C","V"] };

let bancoMomentos = [];
let resultadoPlanosNatural = null;
let valoresBrutosNatural = null;

//================ FUN√á√ïES DE APOIO
function calcularValorComAcentos(letra) {
    const base = letra.normalize("NFD")[0];
    const valorBase = tabela[base] || 0;
    let soma = 0, mult = 1;
    for(let c of letra.normalize("NFD")) {
        if(c==="\u0301") soma+=2; else if(c==="\u0302") soma+=7;
        else if(c==="\u0303") soma+=3; else if(c==="\u0327") soma+=6;
        else if(c==="\u0300" || c==="\u0308") mult*=2;
    }
    return (valorBase + soma) * mult;
}

function reduzirNumero(n) {
    while(n > 9) n = n.toString().split("").reduce((a,b) => a + Number(b), 0);
    return n;
}

function descobrirPlano(letra) {
    let l = letra.normalize("NFD")[0].toUpperCase();
    for(let p in planos) if(planos[p].includes(l)) return p;
    return null;
}

function classificarIntensidade(valor, maior) {
    if (valor >= maior * 0.75) return "forte";
    if (valor >= maior * 0.5) return "medio";
    return "fraco";
}

//================ L√ìGICA DA TABELA 3 (TEXTOS E BARRAS)
function atualizarTabela3(letras, sufixo) {
    let cont = { criativo: 0, indeciso: 0, neutro: 0 };
    letras.forEach(l => {
        if(!l) return;
        let letra = l.normalize("NFD")[0].toUpperCase();
        if (tabelaExpressao[letra]) cont[tabelaExpressao[letra]]++;
    });

    const maior = Math.max(cont.criativo, cont.indeciso, cont.neutro);
    
    // Atualiza as Barras
    ["Criativo", "Indeciso", "Neutro"].forEach(id => {
        let val = cont[id.toLowerCase()];
        let larg = maior > 0 ? Math.max((val / maior) * 100, 12) : 0;
        let elBar = document.getElementById("bar" + id + sufixo);
        let elNum = document.getElementById("num" + id + sufixo);
        if(elBar) elBar.style.width = larg + "%";
        if(elNum) elNum.innerText = val;
}); // Fechamento do forEach das barras (Linha 202 original)

    // Descobre o dominante
    let dominanteExpressao = Object.keys(cont).reduce((a, b) => cont[a] >= cont[b] ? a : b);
    let campoTexto = document.getElementById("resumoExpressao" + sufixo);
    
    if(campoTexto && typeof textosExpressao !== 'undefined') {
        campoTexto.innerHTML = textosExpressao[dominanteExpressao] || "";
        campoTexto.style.display = "block"; 
    }
} // Fechamento da fun√ß√£o atualizarTabela3

//============================== MOTOR DE TEXTOS PLANOS (VERS√ÉO FINAL)
function gerarTextoPlano(tipo, dados) {
    const nomesAmigaveis = {
        fisico: "Plano F√≠sico",
        mental: "Plano Mental",
        emocional: "Plano Emocional",
        intuitivo: "Plano Intuitivo"
    };

    // 1. RANKING: Converte para n√∫mero para o 3 ganhar do 0 sempre
    let planosOrdenados = Object.keys(dados)
        .map(chave => ({ 
            chave, 
            valor: Number(dados[chave].valorReal) || 0, 
            nivel: dados[chave].nivel, 
            num: dados[chave].numero 
        }))
        .sort((a, b) => b.valor - a.valor);

    let textoFinal = (introducoes[tipo] || "") + "\n\n";

    // 2. MONTAGEM DOS PLANOS
    planosOrdenados.forEach((plano, index) => {
        let posicao = index + 1;
        let nomePlano = nomesAmigaveis[plano.chave];
        
        textoFinal += `**${posicao}¬∫ - ${nomePlano} (${plano.valor})**\n`;
        
        if (typeof explicacoesPosicao !== 'undefined') {
            textoFinal += (explicacoesPosicao[posicao] || "") + "\n\n";
        }
        
        if (typeof textosPlanos !== 'undefined' && textosPlanos[plano.chave]) {
            let txt = textosPlanos[plano.chave][plano.nivel][plano.num];
            textoFinal += (txt || "") + "\n\n";
        }
        
        if (index < 3 && typeof conectores !== 'undefined') {
            textoFinal += conectores[Math.floor(Math.random() * conectores.length)] + "\n\n";
        }
    });

// --- IN√çCIO DA L√ìGICA DE INTERPRETA√á√ÉO     // --- IN√çCIO DA L√ìGICA DE INTERPRETA√á√ÉO INTELIGENTE ---
// --- L√ìGICA DE INTERPRETA√á√ÉO BASEADA NO EQUIL√çBRIO (VERS√ÉO REAL) ---
    const valorMaxCenario = Math.max(...planosOrdenados.map(p => p.valor));
    
    // Filtros baseados na sua regra de neg√≥cio
    const fortes = planosOrdenados.filter(p => p.nivel === "forte").map(p => ({ nome: nomesAmigaveis[p.chave], chave: p.chave }));
    const medios = planosOrdenados.filter(p => p.nivel === "medio").map(p => ({ nome: nomesAmigaveis[p.chave], chave: p.chave }));
    const fracos = planosOrdenados.filter(p => p.nivel === "fraco").map(p => ({ nome: nomesAmigaveis[p.chave], chave: p.chave }));

    let analiseFinal = "";

    // 1. CEN√ÅRIO: EXCESSO DE POT√äNCIA (Muitos Fortes)
    if (fortes.length >= 2) {
        analiseFinal = `Sua configura√ß√£o mostra uma predomin√¢ncia de planos **Fortes** em **${fortes.map(f => f.nome).join(" e ")}**. Isso indica uma personalidade de muita for√ßa e prontid√£o, mas que exige cuidado com os excessos. No F√≠sico voc√™ realiza, no Mental voc√™ racionaliza ao extremo, mas essa intensidade pode gerar um transbordo, como uma confus√£o mental ou uma impulsividade f√≠sica. O desafio aqui √© buscar o tempero do "M√©dio" para que essa pot√™ncia n√£o te desgaste.`;
    } 
    
    // 2. CEN√ÅRIO: O EQUIL√çBRIO IDEAL (Predom√≠nio de M√©dios)
    else if (medios.length >= 2) {
        analiseFinal = `Identificamos um excelente **Equil√≠brio Operacional** em sua estrutura, especialmente nos planos **${medios.map(m => m.nome).join(" e ")}**. Estar no n√≠vel M√©dio significa que voc√™ n√£o peca nem pela falta, nem pelo excesso. Voc√™ consegue sentir, pensar ou agir com a medida certa, mantendo a estabilidade necess√°ria para n√£o ser influenciado externamente, mas tamb√©m sem se sobrecarregar com intensidades desnecess√°rias.`;
    }

    // 3. CEN√ÅRIO: VULNERABILIDADE E INFLU√äNCIA (Muitos Fracos)
    else if (fracos.length >= 2) {
        analiseFinal = `Observamos que voc√™ possui planos em n√≠vel **Fraco** em **${fracos.map(f => f.nome).join(" e ")}**. Isso n√£o significa falta de capacidade, mas sim uma maior permeabilidade: voc√™ se torna mais f√°cil de ser influenciado por opini√µes ou energias externas nessas √°reas. Seja pela falta de a√ß√£o f√≠sica ou por uma percep√ß√£o intuitiva menos agu√ßada, o segredo √© fortalecer sua autoconfian√ßa para que esses pontos de "baixa voltagem" n√£o permitam que outros tomem as r√©deas da sua vida.`;
    }

    // 4. CEN√ÅRIO MISTO (O Caso do Intuitivo Forte)
    else if (fortes.some(f => f.chave === 'intuitivo')) {
        analiseFinal = `Destaque especial para o seu **Plano Intuitivo Forte**. Enquanto os outros buscam equil√≠brio, sua percep√ß√£o vai al√©m, alcan√ßando nuances e "coisas obscuras" que a maioria ignora. Voc√™ enxerga o que est√° oculto. Se os seus outros planos estiverem no M√©dio, voc√™ usa essa vis√£o para guiar seus passos com maestria; se estiverem Fracos, essa intui√ß√£o pode te assustar por n√£o ter onde se apoiar na mat√©ria.`;
    }

    // 5. CEN√ÅRIO PADR√ÉO (A din√¢mica entre agir e silenciar)
    else {
        const d = nomesAmigaveis[planosOrdenados[0].chave];
        const f = nomesAmigaveis[planosOrdenados[3].chave];
        analiseFinal = `Sua an√°lise mostra que voc√™ se move primariamente pelo **${d}**. Se ele for Forte, voc√™ lidera e toma as r√©deas; se for Fraco, voc√™ espera o movimento do mundo. O seu maior ponto de aten√ß√£o √© o **${f}**, onde a energia circula menos, exigindo que voc√™ pare de apenas observar e comece a imprimir sua pr√≥pria vontade para n√£o ser apenas um reflexo do ambiente.`;
    }

    return textoFinal + "\n---\n### S√çNTESE DO PERFIL DE EXPRESS√ÉO\n" + analiseFinal;
}




//================ PLANO NATURAL
function planoNatural(nome) {
    let soma = { fisico: 0, mental: 0, emocional: 0, intuitivo: 0 };
    for(let l of nome.toUpperCase()) {
        let p = descobrirPlano(l);
        if(p) soma[p] += calcularValorComAcentos(l);
    }
    const maior = Math.max(soma.fisico, soma.mental, soma.emocional, soma.intuitivo);
    const dados = {
        fisico: { nivel: classificarIntensidade(soma.fisico, maior), numero: reduzirNumero(soma.fisico), valorReal: soma.fisico },
        mental: { nivel: classificarIntensidade(soma.mental, maior), numero: reduzirNumero(soma.mental), valorReal: soma.mental },
        emocional: { nivel: classificarIntensidade(soma.emocional, maior), numero: reduzirNumero(soma.emocional), valorReal: soma.emocional },
        intuitivo: { nivel: classificarIntensidade(soma.intuitivo, maior), numero: reduzirNumero(soma.intuitivo), valorReal: soma.intuitivo }
    };
    resultadoPlanosNatural = dados; valoresBrutosNatural = soma;
    document.getElementById("resumoNatural").innerText = gerarTextoPlano("natural", dados);
    for(let p in soma) atualizarBarraNatural(p.charAt(0).toUpperCase() + p.slice(1) + "Nat", soma[p], maior, dados[p].numero);
    atualizarTabela3(nome.split(""), "Nat");
}

//================ PLANO MOMENTO (COM DATAS EXATAS)
function planoMomento(nomeCompleto, data) {
    bancoMomentos = [];
    const dt = new Date(data + 'T00:00:00');
    const dia = String(dt.getDate()).padStart(2, '0');
    const mes = String(dt.getMonth() + 1).padStart(2, '0');
    const partes = nomeCompleto.toUpperCase().trim().split(/\s+/);
    let timelines = partes.map(p => {
        let t = [];
        for(let l of p) { let v = calcularValorComAcentos(l); for(let i=0; i<v; i++) t.push(l); }
        return t;
    });
    for (let i = 0; i <= 100; i++) {
        let soma = { fisico: 0, mental: 0, emocional: 0, intuitivo: 0 };
        let letras = timelines.map(t => t[i % t.length]);
        letras.forEach(l => {
            let p = descobrirPlano(l);
            if(p) soma[p] += calcularValorComAcentos(l);
        });
        const anoI = dt.getFullYear() + i;
        bancoMomentos.push({ 
            ano: anoI, 
            intervalo: `de ${dia}/${mes}/${anoI} at√© ${dia}/${mes}/${anoI + 1}`, 
            letras: letras, ...soma 
        });
    }
    const sel = document.getElementById("anoSelect");
    sel.innerHTML = bancoMomentos.map(a => `<option value="${a.ano}">${a.ano}</option>`).join("");
}

function gerarStatusMomento() {
    const ano = document.getElementById("anoSelect").value;
    const d = bancoMomentos.find(a => a.ano == ano);
    if (!d) return;
    
    const maior = Math.max(d.fisico, d.mental, d.emocional, d.intuitivo);
    const red = { 
        fisico: reduzirNumero(d.fisico), 
        mental: reduzirNumero(d.mental), 
        emocional: reduzirNumero(d.emocional), 
        intuitivo: reduzirNumero(d.intuitivo) 
    };

    // Atualiza as barras visuais
    for(let p in d) {
        if(p !== "ano" && p !== "letras" && p !== "intervalo") {
            atualizarBarraNatural(p.charAt(0).toUpperCase() + p.slice(1), d[p], maior, reduzirNumero(d[p]));
        }
    }
    
    atualizarTabela3(d.letras, "Mom");

    // AQUI EST√Å O CONSERTO: Enviando o valor bruto (d.fisico, etc) como valorReal
    const dadosTxt = {
        fisico: { nivel: classificarIntensidade(d.fisico, maior), numero: red.fisico, valorReal: d.fisico },
        mental: { nivel: classificarIntensidade(d.mental, maior), numero: red.mental, valorReal: d.mental },
        emocional: { nivel: classificarIntensidade(d.emocional, maior), numero: red.emocional, valorReal: d.emocional },
        intuitivo: { nivel: classificarIntensidade(d.intuitivo, maior), numero: red.intuitivo, valorReal: d.intuitivo }
    };

    document.getElementById("resumoMomento").innerText = "No ano de " + ano + " (" + d.intervalo + "):\n\n" + gerarTextoPlano("momento", dadosTxt);
}

function atualizarBarraNatural(tipo, val, maior, red) {
    let larg = maior > 0 ? Math.max((val/maior)*100, 12) : 0;
    document.getElementById("bar"+tipo).style.width = larg + "%";
    document.getElementById("num"+tipo).innerText = red;
}

function gerarTudo() {
    const n = document.getElementById("nome").value;
    const d = document.getElementById("dataNascimento").value;
    if(!n || !d) return alert("Preencha nome e data.");
    planoNatural(n); planoMomento(n, d); gerarStatusMomento();
}

function exportarRelatorio() {
    if(!resultadoPlanosNatural) return alert("Gere o mapa primeiro.");
    
    const anoSel = document.getElementById("anoSelect").value;
    const dAno = bancoMomentos.find(a => a.ano == anoSel);

    const pacote = {
        nome: document.getElementById("nome").value,
        data: document.getElementById("dataNascimento").value,
        anoMomento: anoSel,
        
        // Dados dos Planos (F√≠sico, Mental, etc)
        fisico: valoresBrutosNatural.fisico,
        mental: valoresBrutosNatural.mental,
        emocional: valoresBrutosNatural.emocional,
        intuitivo: valoresBrutosNatural.intuitivo,
        fisicoMomento: dAno.fisico,
        mentalMomento: dAno.mental,
        emocionalMomento: dAno.emocional,
        intuitivoMomento: dAno.intuitivo,
        
        // Textos dos Planos
        textoNatural: document.getElementById("resumoNatural").innerText,
        textoMomento: document.getElementById("resumoMomento").innerText,

        // === AQUI EST√Å O QUE FALTA PARA O PREMIUM PARAR DE DAR UNDEFINED ===
        
        // N√∫meros da Tabela 3
        criativoNat: document.getElementById("numCriativoNat").innerText,
        indecisoNat: document.getElementById("numIndecisoNat").innerText,
        neutroNat: document.getElementById("numNeutroNat").innerText,
        
        criativoMom: document.getElementById("numCriativoMom").innerText,
        indecisoMom: document.getElementById("numIndecisoMom").innerText,
        neutroMom: document.getElementById("numNeutroMom").innerText,

        // Textos da Tabela 3 (O que aparece na caixa roxa)
        textoExpressaoNat: document.getElementById("resumoExpressaoNat").innerHTML,
        textoExpressaoMom: document.getElementById("resumoExpressaoMom").innerHTML
    };

    localStorage.setItem("relatorioMapa", JSON.stringify(pacote));
    window.open("https://hemricciinstintosuperior-rcci.github.io/app-plano-de-expressao/premium.html", "_blank");
}
</script>


<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}
 // üîí BLOQUEIO C√ìPIA
// =======================
document.oncontextmenu=()=>false;
document.onselectstart=()=>false; 

</script>
</body>
</html>
