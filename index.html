<!DOCTYPE html>
<html lang="pt-br">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plano de Express√£o Cabal√≠stico</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#111827">

<style>
body{font-family:Arial;padding:30px;background:#f4f4f4}
input,button{padding:10px;margin:5px}
.card{background:#fff;padding:20px;margin-top:20px;border-radius:10px}
table{border-collapse:collapse;width:100%;margin-top:15px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
.vermelho{color:#c0392b}
.azul{color:#2980b9}
.verde{color:#27ae60}
.amarelo{color:#f1c40f}

.bloco-momento{
  margin-top:60px;
  padding:30px;
  background:#111827;
  color:white;
  border-radius:10px;
}
.bar-bg{background:#2a2a2a;height:18px;border-radius:10px;margin:8px 0;}
.bar{height:100%;width:0%;border-radius:10px;transition:1s;}
.fisico{background:#ff4d4d;}
.mental{background:#4da6ff;}
.emocional{background:#33cc66;}
.intuitivo{background:#ffd633;}
.criativo { background: #a855f7; } 
.indeciso { background: #f97316; } 
.neutro { background: #94a3b8; }  
.resumoMomento{margin-top:25px;padding:20px;background:#1f2937;border-radius:8px;}
/* Esconde o texto que fica abaixo das barras */
#txtFisicoNat, #txtMentalNat, #txtEmocionalNat, #txtIntuitivoNat,
#txtFisico, #txtMental, #txtEmocional, #txtIntuitivo {
    display: none;
}
input {
  width: 600px;
  font-size: 18px;
  padding: 14px;
  background-color: #e5e7eb; /* Cor cinza id√™ntica ao padr√£o do sistema */
  border: 1px solid #ccc;    /* Borda suave para dar profundidade */
  color: #333;               /* Cor do texto ao digitar */
  display: block;            /* Garante que fiquem um abaixo do outro */
  margin: 10px auto;         /* Centraliza e d√° espa√ßamento */
}
  
/* MOBILE */
@media (max-width:768px){
  body{padding:15px;}
  h1{font-size:28px;}
  input,button,select{width:100%;box-sizing:border-box;margin:8px 0;}
  .bloco-momento{padding:20px;margin-top:30px;}
}

 /* Isso for√ßa os campos a aparecerem e ficarem empilhados no celular */
@media (max-width: 768px) {
    .container-inputs { /* Use a classe que envolve seus inputs */
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    input, select {
        display: block !important; /* For√ßa a exibi√ß√£o */
        width: 90% !important;     /* Ajusta a largura para o celular */
        margin-bottom: 25px;      /* D√° um espa√ßo entre o nome e a data */
    }
} 
</style>

</head>
<body>



<h1>Plano de Express√£o Qu√¢ntico</h1>

Nome Completo (igual certid√£o)<input id="nome" placeholder="">
            Data de Nascimento<input type="date" id="dataNascimento" required data-placeholder="Data de Nascimento">
                 

  
<button onclick="gerarTudo()">GERAR MAPA</button>
<button onclick="exportarRelatorio()">GERAR RELAT√ìRIO PDF</button>

<div id="natural" class="card"></div>
<div id="momento" style="display:none"></div>
<section class="bloco-momento" id="blocoNatural">
<h2>PLANO NATURAL</h2>

<div>
F√≠sico: <span id="numFisicoNat"></span><div class="bar-bg"><div id="barFisicoNat" class="bar fisico"></div></div><p id="txtFisicoNat"></p>
Mental: <span id="numMentalNat"></span><div class="bar-bg"><div id="barMentalNat" class="bar mental"></div></div><p id="txtMentalNat"></p>
Emocional: <span id="numEmocionalNat"></span><div class="bar-bg"><div id="barEmocionalNat" class="bar emocional"></div></div><p id="txtEmocionalNat"></p>
Intuitivo: <span id="numIntuitivoNat"></span><div class="bar-bg"><div id="barIntuitivoNat" class="bar intuitivo"></div></div><p id="txtIntuitivoNat"></p>
<hr style="border: 0; border-top: 1px solid #374151; margin: 20px 0;">
Criativo: <span id="numCriativoNat"></span><div class="bar-bg"><div id="barCriativoNat" class="bar criativo"></div></div>
Indeciso: <span id="numIndecisoNat"></span><div class="bar-bg"><div id="barIndecisoNat" class="bar indeciso"></div></div>
Neutro: <span id="numNeutroNat"></span><div class="bar-bg"><div id="barNeutroNat" class="bar neutro"></div></div>  
</div>

<div id="resumoNatural" class="resumoMomento"></div>
</section>
<section class="bloco-momento">
<h2>STATUS DO MOMENTO</h2>

<select id="anoSelect"></select>
<button onclick="gerarStatusMomento()">Gerar Status</button>

<div>
F√≠sico: <span id="numFisico"></span><div class="bar-bg"><div id="barFisico" class="bar fisico"></div></div><p id="txtFisico"></p>
Mental: <span id="numMental"></span><div class="bar-bg"><div id="barMental" class="bar mental"></div></div><p id="txtMental"></p>
Emocional: <span id="numEmocional"></span><div class="bar-bg"><div id="barEmocional" class="bar emocional"></div></div><p id="txtEmocional"></p>
Intuitivo: <span id="numIntuitivo"></span><div class="bar-bg"><div id="barIntuitivo" class="bar intuitivo"></div></div><p id="txtIntuitivo"></p>
<hr style="border: 0; border-top: 1px solid #374151; margin: 20px 0;">
Criativo: <span id="numCriativoMom"></span><div class="bar-bg"><div id="barCriativoMom" class="bar criativo"></div></div>
Indeciso: <span id="numIndecisoMom"></span><div class="bar-bg"><div id="barIndecisoMom" class="bar indeciso"></div></div>
Neutro: <span id="numNeutroMom"></span><div class="bar-bg"><div id="barNeutroMom" class="bar neutro"></div></div>  
</div>

<div id="resumoMomento" class="resumoMomento"></div>
</section>
<script src="textos.js"></script>
<script>
//================ TABELA CABAL√çSTICA
//================ TABELA CABAL√çSTICA
const tabela={
A:1,J:1,I:1,Q:1,Y:1,
B:2,K:2,R:2,
C:3,G:3,L:3,S:3,
D:4,M:4,T:4,
E:5,H:5,N:5,
U:6,V:6,W:6,X:6,√á:6,
O:7,Z:7,
F:8,P:8
};

//================ MAPEAMENTO DA TABELA 3 (CRIATIVO, INDECISO, NEUTRO)
const tabelaExpressao = {
    'E':'criativo','W':'indeciso','D':'neutro','M':'neutro',
    'A':'criativo','H':'indeciso','J':'indeciso','N':'indeciso','P':'indeciso','G':'neutro','L':'neutro',
    'I':'criativo','O':'criativo','R':'criativo','Z':'criativo','B':'indeciso','S':'indeciso','T':'indeciso','X':'indeciso',
    'K':'criativo','F':'indeciso','Q':'indeciso','U':'indeciso','Y':'indeciso','C':'neutro','V':'neutro'
};

function atualizarTabela3(letras, sufixo) {
    let contagem = { criativo: 0, indeciso: 0, neutro: 0 };
    letras.forEach(l => {
        if(!l) return;
        let letra = l.normalize("NFD")[0].toUpperCase();
        let tipo = tabelaExpressao[letra];
        if (tipo) contagem[tipo]++;
    });
    const maior = Math.max(contagem.criativo, contagem.indeciso, contagem.neutro);
    const setBar = (id, valor) => {
        let largura = maior > 0 ? (valor / maior) * 100 : 0;
        if (largura > 0 && largura < 12) largura = 12;
        const barEl = document.getElementById("bar" + id + sufixo);
        const numEl = document.getElementById("num" + id + sufixo);
        if(barEl) barEl.style.width = largura + "%";
        if(numEl) numEl.innerText = valor;
    };
    setBar("Criativo", contagem.criativo);
    setBar("Indeciso", contagem.indeciso);
    setBar("Neutro", contagem.neutro);
}

//================ FUN√á√ïES DE APOIO
function calcularValorComAcentos(letra){
 const base=letra.normalize("NFD")[0];
 const valorBase=tabela[base];
 if(!valorBase) return 0;
 let soma=0,mult=1;
 for(let c of letra.normalize("NFD")){
  if(c==="\u0301") soma+=2;
  else if(c==="\u0302") soma+=7;
  else if(c==="\u0303") soma+=3;
  else if(c==="\u0327") soma+=6;
  else if(c==="\u0300") mult*=2;
  else if(c==="\u0308") mult*=2;
 }
 return (valorBase+soma)*mult;
}

function reduzirNumero(n){
 while(n > 9){
  n = n.toString().split("").reduce((a,b)=>a + Number(b),0);
 }
 return n;
}

function descobrirPlano(letra){
 if(!letra) return null;
 letra=letra.normalize("NFD")[0].toUpperCase();
 for(let p in planos) if(planos[p].includes(letra)) return p;
 return null;
}

function classificarIntensidade(valor, maior) {
    if (valor >= maior * 0.75) return "forte";
    if (valor >= maior * 0.5) return "medio";
    return "fraco";
}

const planos={
 fisico:["E","W","D","M"],
 mental:["A","H","J","N","P","G","L"],
 emocional:["I","O","R","Z","B","S","T","X"],
 intuitivo:["K","F","Q","U","Y","C","V"]
};

//================ DADOS GLOBAIS
let bancoMomentos=[];
let resultadoPlanosNatural = null;
let valoresBrutosNatural = null;  

//================ PLANO NATURAL
function planoNatural(nome){
 let soma={fisico:0,mental:0,emocional:0,intuitivo:0};
 for(let l of nome.toUpperCase()){
  let plano=descobrirPlano(l);
  if(!plano) continue;
  soma[plano]+=calcularValorComAcentos(l);
 }
 const maior=Math.max(soma.fisico,soma.mental,soma.emocional,soma.intuitivo);
 const reducoes = {
  fisico: reduzirNumero(soma.fisico),
  mental: reduzirNumero(soma.mental),
  emocional: reduzirNumero(soma.emocional),
  intuitivo: reduzirNumero(soma.intuitivo)
 };

 const intensidades = {
  fisico: classificarIntensidade(soma.fisico, maior),
  mental: classificarIntensidade(soma.mental, maior),
  emocional: classificarIntensidade(soma.emocional, maior),
  intuitivo: classificarIntensidade(soma.intuitivo, maior)
 };

 const dadosTexto = {
  fisico: { nivel:intensidades.fisico, numero:reducoes.fisico, valorReal:soma.fisico },
  mental: { nivel:intensidades.mental, numero:reducoes.mental, valorReal:soma.mental },
  emocional: { nivel:intensidades.emocional, numero:reducoes.emocional, valorReal:soma.emocional },
  intuitivo: { nivel:intensidades.intuitivo, numero:reducoes.intuitivo, valorReal:soma.intuitivo }
 };

 document.getElementById("resumoNatural").innerText = gerarTextoPlano("natural", dadosTexto);
 resultadoPlanosNatural = dadosTexto;
 valoresBrutosNatural = soma; 

 atualizarBarraNatural("FisicoNat",soma.fisico,maior,reducoes.fisico);
 atualizarBarraNatural("MentalNat",soma.mental,maior,reducoes.mental);
 atualizarBarraNatural("EmocionalNat",soma.emocional,maior,reducoes.emocional);
 atualizarBarraNatural("IntuitivoNat",soma.intuitivo,maior,reducoes.intuitivo);

 atualizarTabela3(nome.split(""), "Nat");  
}

//================ L√ìGICA DO MOMENTO
function planoMomento(nomeCompleto, data) {
  bancoMomentos = [];
  const dataNascimento = new Date(data + 'T00:00:00'); 
  const dia = String(dataNascimento.getDate()).padStart(2, '0');
  const mes = String(dataNascimento.getMonth() + 1).padStart(2, '0');
  const anoNasc = dataNascimento.getFullYear();

  const partes = nomeCompleto.toUpperCase().trim().split(/\s+/);
  let blocos = [];
  let buffer = "";
  partes.forEach(p => {
    if (["DA", "DE", "DO", "DAS", "DOS"].includes(p)) buffer += p;
    else { blocos.push(buffer + p); buffer = ""; }
  });

  let timelines = [];
  blocos.forEach(nome => {
    let timeline = [];
    for (let letra of nome) {
      const anos = calcularValorComAcentos(letra);
      for (let i = 0; i < anos; i++) timeline.push(letra);
    }
    timelines.push(timeline);
  });

  for (let idade = 0; idade <= 100; idade++) {
    const anoInicio = anoNasc + idade;
    const intervaloData = `de ${dia}/${mes}/${anoInicio} at√© ${dia}/${mes}/${anoInicio + 1}`;
    let soma = { fisico: 0, mental: 0, emocional: 0, intuitivo: 0 };
    let letrasAtivas = [];

    timelines.forEach(timeline => {
      const letra = timeline[idade % timeline.length];
      const plano = descobrirPlano(letra);
      const valor = calcularValorComAcentos(letra);
      if (plano) soma[plano] += valor;
      letrasAtivas.push(letra);
    });

    bancoMomentos.push({ 
      ano: anoInicio, 
      intervalo: intervaloData, 
      letras: letrasAtivas,
      ...soma 
    });
  }
  preencherSeletorAnos();
}

function preencherSeletorAnos(){
 const select=document.getElementById("anoSelect");
 select.innerHTML="";
 bancoMomentos.forEach(a=>{ select.innerHTML+=`<option value="${a.ano}">${a.ano}</option>`; });
 if(bancoMomentos.length > 0) select.value = new Date().getFullYear();
}

function gerarStatusMomento() {
    const anoSelecionado = document.getElementById("anoSelect").value;
    const dados = bancoMomentos.find(a => a.ano == anoSelecionado);
    if (!dados) return;

    const maiorBruto = Math.max(dados.fisico, dados.mental, dados.emocional, dados.intuitivo);
    const reducoes = {
        fisico: reduzirNumero(dados.fisico),
        mental: reduzirNumero(dados.mental),
        emocional: reduzirNumero(dados.emocional),
        intuitivo: reduzirNumero(dados.intuitivo)
    };

    atualizarBarraNatural("Fisico", dados.fisico, maiorBruto, reducoes.fisico);
    atualizarBarraNatural("Mental", dados.mental, maiorBruto, reducoes.mental);
    atualizarBarraNatural("Emocional", dados.emocional, maiorBruto, reducoes.emocional);
    atualizarBarraNatural("Intuitivo", dados.intuitivo, maiorBruto, reducoes.intuitivo);

    // Atualiza a Tabela 3 do Momento usando as letras calculadas para aquele ano
    atualizarTabela3(dados.letras, "Mom");

    const dadosTextoMomento = {
        fisico: { nivel: classificarIntensidade(dados.fisico, maiorBruto), numero: reducoes.fisico },
        mental: { nivel: classificarIntensidade(dados.mental, maiorBruto), numero: reducoes.mental },
        emocional: { nivel: classificarIntensidade(dados.emocional, maiorBruto), numero: reducoes.emocional },
        intuitivo: { nivel: classificarIntensidade(dados.intuitivo, maiorBruto), numero: reducoes.intuitivo }
    };

    const textoBase = gerarTextoPlano("momento", dadosTextoMomento);
    const campoTexto = document.getElementById("resumoMomento");
    campoTexto.innerText = "No ano de " + anoSelecionado + " (" + dados.intervalo + "):\n\n" + textoBase;
    campoTexto.style.display = "block";
}

function atualizarBarraNatural(tipo, valorBruto, maiorBruto, reducao) {
    let largura = (maiorBruto > 0 && valorBruto > 0) ? (valorBruto / maiorBruto) * 100 : 0;
    if (largura > 0 && largura < 12) largura = 12;
    const elBar = document.getElementById("bar" + tipo);
    const elNum = document.getElementById("num" + tipo);
    if (elBar) elBar.style.width = largura + "%";
    if (elNum) elNum.innerText = reducao;
}

function gerarTudo(){
  const nome = document.getElementById("nome").value;
  const data = document.getElementById("dataNascimento").value;
  if(!nome || !data){ alert("Digite nome e data."); return; }
  planoNatural(nome);
  planoMomento(nome, data);
  gerarStatusMomento();
}

function exportarRelatorio(){
 const nome = document.getElementById("nome").value;
 const data = document.getElementById("dataNascimento").value;
 const anoSelecionado = document.getElementById("anoSelect").value;
 if(!nome || !data || bancoMomentos.length === 0){ alert("Gere o mapa antes de exportar."); return; }

 const dadosAno = bancoMomentos.find(a => a.ano == anoSelecionado);
 const pacoteRelatorio = {
  nome, data, anoMomento: anoSelecionado,
  fisico: valoresBrutosNatural.fisico,
  mental: valoresBrutosNatural.mental,
  emocional: valoresBrutosNatural.emocional,
  intuitivo: valoresBrutosNatural.intuitivo,
  fisicoMomento: dadosAno.fisico,
  mentalMomento: dadosAno.mental,
  emocionalMomento: dadosAno.emocional,
  intuitivoMomento: dadosAno.intuitivo,
  textoNatural: document.getElementById("resumoNatural").innerText,
  textoMomento: document.getElementById("resumoMomento").innerText
 };
 localStorage.setItem("relatorioMapa", JSON.stringify(pacoteRelatorio));
 window.open("https://hemricciinstintosuperior-rcci.github.io/app-plano-de-expressao/premium.html", "_blank");
}
</script>


<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}
 // üîí BLOQUEIO C√ìPIA
// =======================
document.oncontextmenu=()=>false;
document.onselectstart=()=>false; 

</script>
</body>
</html>
