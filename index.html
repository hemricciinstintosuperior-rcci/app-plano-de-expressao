<!DOCTYPE html>
<html lang="pt-br">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plano de Express√£o Cabal√≠stico</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#111827">

<style>
body{font-family:Arial;padding:30px;background:#f4f4f4}
input,button{padding:10px;margin:5px}
.card{background:#fff;padding:20px;margin-top:20px;border-radius:10px}
table{border-collapse:collapse;width:100%;margin-top:15px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
.vermelho{color:#c0392b}
.azul{color:#2980b9}
.verde{color:#27ae60}
.amarelo{color:#f1c40f}

.bloco-momento{
  margin-top:60px;
  padding:30px;
  background:#111827;
  color:white;
  border-radius:10px;
}
.bar-bg{background:#2a2a2a;height:18px;border-radius:10px;margin:8px 0;}
.bar{height:100%;width:0%;border-radius:10px;transition:1s;}
.fisico{background:#ff4d4d;}
.mental{background:#4da6ff;}
.emocional{background:#33cc66;}
.intuitivo{background:#ffd633;}
.criativo { background: #a855f7; } 
.indeciso { background: #f97316; } 
.neutro { background: #94a3b8; }  
.resumoMomento{margin-top:25px;padding:20px;background:#1f2937;border-radius:8px;}
/* Esconde o texto que fica abaixo das barras */
#txtFisicoNat, #txtMentalNat, #txtEmocionalNat, #txtIntuitivoNat,
#txtFisico, #txtMental, #txtEmocional, #txtIntuitivo {
    display: none;
}
input {
  width: 600px;
  font-size: 18px;
  padding: 14px;
  background-color: #e5e7eb; /* Cor cinza id√™ntica ao padr√£o do sistema */
  border: 1px solid #ccc;    /* Borda suave para dar profundidade */
  color: #333;               /* Cor do texto ao digitar */
  display: block;            /* Garante que fiquem um abaixo do outro */
  margin: 10px auto;         /* Centraliza e d√° espa√ßamento */
}
  
/* MOBILE */
@media (max-width:768px){
  body{padding:15px;}
  h1{font-size:28px;}
  input,button,select{width:100%;box-sizing:border-box;margin:8px 0;}
  .bloco-momento{padding:20px;margin-top:30px;}
}

 /* Isso for√ßa os campos a aparecerem e ficarem empilhados no celular */
@media (max-width: 768px) {
    .container-inputs { /* Use a classe que envolve seus inputs */
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    input, select {
        display: block !important; /* For√ßa a exibi√ß√£o */
        width: 90% !important;     /* Ajusta a largura para o celular */
        margin-bottom: 25px;      /* D√° um espa√ßo entre o nome e a data */
    }
} 
</style>

</head>
<body>



<h1>Plano de Express√£o Qu√¢ntico</h1>

Nome Completo (igual certid√£o)<input id="nome" placeholder="">
            Data de Nascimento<input type="date" id="dataNascimento" required data-placeholder="Data de Nascimento">
                 

  
<button onclick="gerarTudo()">GERAR MAPA</button>
<button onclick="exportarRelatorio()">GERAR RELAT√ìRIO PDF</button>

<div id="natural" class="card"></div>
<div id="momento" style="display:none"></div>
<section class="bloco-momento" id="blocoNatural">
<h2>PLANO NATURAL</h2>

<div>
F√≠sico: <span id="numFisicoNat"></span><div class="bar-bg"><div id="barFisicoNat" class="bar fisico"></div></div><p id="txtFisicoNat"></p>
Mental: <span id="numMentalNat"></span><div class="bar-bg"><div id="barMentalNat" class="bar mental"></div></div><p id="txtMentalNat"></p>
Emocional: <span id="numEmocionalNat"></span><div class="bar-bg"><div id="barEmocionalNat" class="bar emocional"></div></div><p id="txtEmocionalNat"></p>
Intuitivo: <span id="numIntuitivoNat"></span><div class="bar-bg"><div id="barIntuitivoNat" class="bar intuitivo"></div></div><p id="txtIntuitivoNat"></p>
<hr style="border: 0; border-top: 1px solid #374151; margin: 20px 0;">
Criativo: <span id="numCriativoNat"></span><div class="bar-bg"><div id="barCriativoNat" class="bar criativo"></div></div>
Indeciso: <span id="numIndecisoNat"></span><div class="bar-bg"><div id="barIndecisoNat" class="bar indeciso"></div></div>
Neutro: <span id="numNeutroNat"></span><div class="bar-bg"><div id="barNeutroNat" class="bar neutro"></div></div>  
</div>

<div id="resumoNatural" class="resumoMomento"></div>
</section>
<section class="bloco-momento">
<h2>STATUS DO MOMENTO</h2>

<select id="anoSelect"></select>
<button onclick="gerarStatusMomento()">Gerar Status</button>

<div>
F√≠sico: <span id="numFisico"></span><div class="bar-bg"><div id="barFisico" class="bar fisico"></div></div><p id="txtFisico"></p>
Mental: <span id="numMental"></span><div class="bar-bg"><div id="barMental" class="bar mental"></div></div><p id="txtMental"></p>
Emocional: <span id="numEmocional"></span><div class="bar-bg"><div id="barEmocional" class="bar emocional"></div></div><p id="txtEmocional"></p>
Intuitivo: <span id="numIntuitivo"></span><div class="bar-bg"><div id="barIntuitivo" class="bar intuitivo"></div></div><p id="txtIntuitivo"></p>
<hr style="border: 0; border-top: 1px solid #374151; margin: 20px 0;">
Criativo: <span id="numCriativoMom"></span><div class="bar-bg"><div id="barCriativoMom" class="bar criativo"></div></div>
Indeciso: <span id="numIndecisoMom"></span><div class="bar-bg"><div id="barIndecisoMom" class="bar indeciso"></div></div>
Neutro: <span id="numNeutroMom"></span><div class="bar-bg"><div id="barNeutroMom" class="bar neutro"></div></div>  
</div>

<div id="resumoMomento" class="resumoMomento"></div>
</section>
<script src="textos.js"></script>
<script>
//================ TABELA CABAL√çSTICA
const tabela={
A:1,J:1,I:1,Q:1,Y:1,
B:2,K:2,R:2,
C:3,G:3,L:3,S:3,
D:4,M:4,T:4,
E:5,H:5,N:5,
U:6,V:6,W:6,X:6,√á:6,
O:7,Z:7,
F:8,P:8
};
//================ MAPEAMENTO DA TABELA 3 (CRIATIVO, INDECISO, NEUTRO)
const tabelaExpressao = {
    'E':'criativo','W':'indeciso','D':'neutro','M':'neutro',
    'A':'criativo','H':'indeciso','J':'indeciso','N':'indeciso','P':'indeciso','G':'neutro','L':'neutro',
    'I':'criativo','O':'criativo','R':'criativo','Z':'criativo','B':'indeciso','S':'indeciso','T':'indeciso','X':'indeciso',
    'K':'criativo','F':'indeciso','Q':'indeciso','U':'indeciso','Y':'indeciso','C':'neutro','V':'neutro'
};

function atualizarTabela3(letras, sufixo) {
    let contagem = { criativo: 0, indeciso: 0, neutro: 0 };
    letras.forEach(l => {
        let letra = l.normalize("NFD")[0].toUpperCase();
        let tipo = tabelaExpressao[letra];
        if (tipo) contagem[tipo]++;
    });
    const maior = Math.max(contagem.criativo, contagem.indeciso, contagem.neutro);
    const setBar = (id, valor) => {
        let largura = maior > 0 ? (valor / maior) * 100 : 0;
        if (largura > 0 && largura < 12) largura = 12;
        document.getElementById("bar" + id + sufixo).style.width = largura + "%";
        document.getElementById("num" + id + sufixo).innerText = valor;
    };
    setBar("Criativo", contagem.criativo);
    setBar("Indeciso", contagem.indeciso);
    setBar("Neutro", contagem.neutro);
}
//================ ACENTOS
function calcularValorComAcentos(letra){
 const base=letra.normalize("NFD")[0];
 const valorBase=tabela[base];
 if(!valorBase) return 0;
 let soma=0,mult=1;
 for(let c of letra.normalize("NFD")){
  if(c==="\u0301") soma+=2;
  else if(c==="\u0302") soma+=7;
  else if(c==="\u0303") soma+=3;
  else if(c==="\u0327") soma+=6;
  else if(c==="\u0300") mult*=2;
  else if(c==="\u0308") mult*=2;
 }
 return (valorBase+soma)*mult;
}

function gerarTextoPlano(tipo, dados){

  let textoFinal = gerarIntroducao(tipo, dados) + "\n\n";

  const ordemPlanos = ["fisico","mental","emocional","intuitivo"];

  // üîπ INTRODU√á√ÉO
  if(introducoes && introducoes[tipo]){
    textoFinal += introducoes[tipo].trim() + "\n\n";
  }

  ordemPlanos.forEach((plano, i)=>{

    const nivel = dados[plano].nivel;   // fraco medio forte
    const numero = dados[plano].numero; // 1 a 9

   
    // üîπ CONECTOR ENTRE PLANOS
    if(i > 0){
      const conector = conectores[Math.floor(Math.random()*conectores.length)];
      textoFinal += "\n\n" + conector + "\n\n";
    }

  

// üîπ NOVO MOTOR (BANCO textosPlanos)
let blocoPlano = textosPlanos?.[plano]?.[nivel]?.[numero] || 
`[Texto ainda n√£o criado: ${plano} ${nivel} n¬∫ ${numero}]`;

    textoFinal += blocoPlano;

  });

  // üîπ CONCLUS√ÉO
  if(conclusoes && conclusoes[tipo]){
    textoFinal += "\n\n" + conclusoes[tipo].trim();
  }

 textoFinal += "\n\n" + gerarConclusao(tipo, dados);
return textoFinal;
}



// ===============================
// ANALISADOR GERAL DO MAPA
// ===============================

function analisarMapa(dados){

  const planos = ["fisico","mental","emocional","intuitivo"];

  let fortes = [];
  let medios = [];
  let fracos = [];

  planos.forEach(p=>{
    if(dados[p].nivel === "forte") fortes.push(p);
    else if(dados[p].nivel === "medio") medios.push(p);
    else fracos.push(p);
  });

  // plano dominante (se existir)
  let dominante = fortes.length === 1 ? fortes[0] : null;

  // dupla dominante
  let duplaDominante = fortes.length === 2 ? fortes : null;

  // equil√≠brio geral
  let equilibrado = fortes.length === 0 && fracos.length === 0;

  // mapa muito interno (mental + emocional + intuitivo fortes)
  let interno = fortes.filter(p=>p!=="fisico").length >= 2;

  // mapa muito pr√°tico (fisico forte + outro forte)
  let pratico = fortes.includes("fisico") && fortes.length >= 2;

  return {
    fortes,
    medios,
    fracos,
    dominante,
    duplaDominante,
    equilibrado,
    interno,
    pratico
  };
}

// ===============================
// INTRODU√á√ÉO AUTOM√ÅTICA DO MAPA
// ===============================

function gerarIntroducao(tipo, dadosTexto){
  const analise = analisarMapa(dadosTexto);
  let texto = "";

  // ================= PAR√ÅGRAFO 1 ‚Äî CONTEXTUALIZA√á√ÉO (O "PORQU√ä")
  if(tipo === "natural"){
    texto += "O seu Plano de Express√£o Natural representa a sua 'assinatura energ√©tica' fundamental. Ele descreve o conjunto de ferramentas que sua alma trouxe para esta exist√™ncia, revelando como sua intelig√™ncia, emo√ß√£o e instinto operam de forma estrutural e permanente. ";
  } else {
    texto += "O Plano de Express√£o do Momento atua como uma lente temporal sobre a sua ess√™ncia. Ele indica como as circunst√¢ncias atuais est√£o moldando sua forma de agir e sentir, destacando quais habilidades est√£o sendo mais exigidas ou despertadas neste ciclo espec√≠fico da sua jornada. ";
  }

  // ================= PAR√ÅGRAFO 2 ‚Äî A AN√ÅLISE T√âCNICA (O "O QUE")
  texto += "\n\nAo analisarmos a distribui√ß√£o das suas for√ßas, ";

  if(analise.dominante){
    texto += `percebemos que o plano ${analise.dominante} exerce uma influ√™ncia soberana. Isso significa que, independentemente da situa√ß√£o, sua primeira resposta ao mundo tende a passar por esse filtro, tornando-se sua maior for√ßa e, simultaneamente, seu porto seguro para tomada de decis√µes. `;
  }
  else if(analise.duplaDominante){
    texto += `notamos uma din√¢mica fascinante de dupla predomin√¢ncia entre os planos ${analise.duplaDominante[0]} e ${analise.duplaDominante[1]}. Essa composi√ß√£o cria um temperamento rico e equilibrado entre duas frentes, permitindo que voc√™ alterne sua forma de atua√ß√£o com maior fluidez e versatilidade. `;
  }
  else if(analise.equilibrado){
    texto += "encontramos um estado de raridade: o equil√≠brio quase absoluto entre os quatro planos. Isso indica uma personalidade altamente adapt√°vel, capaz de acessar o f√≠sico, o mental, o emocional ou o intuitivo com a mesma facilidade, dependendo apenas do que o momento exige. ";
  }

  // ================= PAR√ÅGRAFO 3 ‚Äî O DESAFIO (AS SOMBRAS)
  if(analise.fracos.length > 0){
    texto += `\n\nPor outro lado, os planos ${analise.fracos.join(" e ")} aparecem com uma atividade mais discreta. No contexto do autoconhecimento, essas n√£o s√£o falhas, mas sim 'zonas de aprendizado'. Elas apontam para habilidades que voc√™ pode sentir dificuldade em acessar instintivamente e que, portanto, demandam um esfor√ßo mais consciente e deliberado para serem integradas √† sua rotina. `;
  }

  // ================= PAR√ÅGRAFO 4 ‚Äî A S√çNTESE FINAL
  texto += "\n\nAbaixo, detalharemos como cada uma dessas energias se comporta individualmente, oferecendo uma vis√£o clara de como voc√™ pode otimizar seu potencial.";

  return texto;
}

function gerarConclusao(tipo, dados){

  const nomes = {
    fisico:"plano f√≠sico",
    mental:"plano mental",
    emocional:"plano emocional",
    intuitivo:"plano intuitivo"
  };

  // transforma objeto em array orden√°vel
  const ordenado = Object.keys(dados)
    .map(plano => ({
      plano,
      valor: dados[plano].valorReal ?? dados[plano].numero ?? 0
    }))
    .sort((a,b) => b.valor - a.valor);

  const dominante = ordenado[0].plano;
  const fraco = ordenado[ordenado.length - 1].plano;

  return `
Concluindo, √© revelado a predomin√¢ncia do ${nomes[dominante]},
enquanto o ${nomes[fraco]} aparece como √°rea que exige maior aten√ß√£o,
equil√≠brio e desenvolvimento consciente.

A integra√ß√£o harmoniosa desses quatro planos representa o caminho
para maior estabilidade, evolu√ß√£o pessoal e realiza√ß√£o pr√°tica ao
longo da vida.
  `;
}

function reduzirNumero(n){
 while(n > 9){
  n = n.toString().split("").reduce((a,b)=>a + Number(b),0);
 }
 return n;
}
//================ PLANOS
const planos={
 fisico:["E","W","D","M"],
 mental:["A","H","J","N","P","G","L"],
 emocional:["I","O","R","Z","B","S","T","X"],
 intuitivo:["K","F","Q","U","Y","C","V"]
};

function descobrirPlano(letra){
 letra=letra.normalize("NFD")[0].toUpperCase();
 for(let p in planos) if(planos[p].includes(letra)) return p;
 return null;
}

//================ BANCO ANUAL
let bancoMomentos=[];
// ===== DADOS GLOBAIS PARA O RELAT√ìRIO PREMIUM =====
let resultadoPlanosNatural = null;
let textoPlanoNaturalFinal = "";
let valoresBrutosNatural = null;  
//================ PLANO NATURAL
function planoNatural(nome){

 let soma={fisico:0,mental:0,emocional:0,intuitivo:0};

 for(let l of nome.toUpperCase()){
  let plano=descobrirPlano(l);
  if(!plano) continue;
  soma[plano]+=calcularValorComAcentos(l);
 }

 const maior=Math.max(soma.fisico,soma.mental,soma.emocional,soma.intuitivo);

// üî¢ N√öMEROS REDUZIDOS (1 a 9)
const reducoes = {
 fisico: reduzirNumero(soma.fisico),
 mental: reduzirNumero(soma.mental),
 emocional: reduzirNumero(soma.emocional),
 intuitivo: reduzirNumero(soma.intuitivo)
};
// üîµ gera classifica√ß√£o de intensidade
function classificar(valor, maior){
 if(valor >= maior*0.75) return "forte";
 if(valor >= maior*0.5) return "medio";
 return "fraco";
}

const intensidades = {
 fisico: classificar(soma.fisico, maior),
 mental: classificar(soma.mental, maior),
 emocional: classificar(soma.emocional, maior),
 intuitivo: classificar(soma.intuitivo, maior)
};

// monta objeto no formato correto para o gerador de texto
const dadosTexto = {
  fisico: { nivel:intensidades.fisico, numero:reducoes.fisico, valorReal:soma.fisico },
  mental: { nivel:intensidades.mental, numero:reducoes.mental, valorReal:soma.mental },
  emocional: { nivel:intensidades.emocional, numero:reducoes.emocional, valorReal:soma.emocional },
  intuitivo: { nivel:intensidades.intuitivo, numero:reducoes.intuitivo, valorReal:soma.intuitivo }
};

// gera texto final correto
const textoPlanoNatural = gerarTextoPlano("natural", dadosTexto);
// salva para o relat√≥rio premium
resultadoPlanosNatural = dadosTexto;
textoPlanoNaturalFinal = textoPlanoNatural;  
 // ‚≠ê SALVA OS N√öMEROS REAIS (ESSENCIAL PARA O GR√ÅFICO DO PREMIUM)
valoresBrutosNatural = soma; 

// mostra na tela
document.getElementById("resumoNatural").innerText = textoPlanoNatural;


atualizarBarraNatural("FisicoNat",soma.fisico,maior,reducoes.fisico);
atualizarBarraNatural("MentalNat",soma.mental,maior,reducoes.mental);
atualizarBarraNatural("EmocionalNat",soma.emocional,maior,reducoes.emocional);
atualizarBarraNatural("IntuitivoNat",soma.intuitivo,maior,reducoes.intuitivo);

atualizarTabela3(nome.split(""), "Nat");  

}

function planoMomento(nomeCompleto, data) {
  bancoMomentos = [];

  // 1. Captura a data de nascimento e separa dia e m√™s
  const dataNascimento = new Date(data + 'T00:00:00'); 
  const dia = String(dataNascimento.getDate()).padStart(2, '0');
  const mes = String(dataNascimento.getMonth() + 1).padStart(2, '0');
  const anoNasc = dataNascimento.getFullYear();

  // 2. L√≥gica de separa√ß√£o do nome
  const partes = nomeCompleto.toUpperCase().trim().split(/\s+/);
  let blocos = [];
  let buffer = "";

  partes.forEach(p => {
    if (["DA", "DE", "DO", "DAS", "DOS"].includes(p)) {
      buffer += p;
    } else {
      blocos.push(buffer + p);
      buffer = "";
    }
  });

  // 3. Montagem das timelines
  let timelines = [];
  blocos.forEach(nome => {
    let timeline = [];
    for (let letra of nome) {
      const anos = calcularValorComAcentos(letra);
      for (let i = 0; i < anos; i++) {
        timeline.push(letra);
      }
    }
    timelines.push(timeline);
  });

  if (timelines.length === 0) return;

  // 4. C√°lculo ano a ano com o novo intervalo de datas
  for (let idade = 0; idade <= 100; idade++) {
    const anoInicio = anoNasc + idade;
    const anoFim = anoInicio + 1;

    // Criamos a frase do intervalo
    const intervaloData = `de ${dia}/${mes}/${anoInicio} at√© ${dia}/${mes}/${anoFim}`;

    let soma = { fisico: 0, mental: 0, emocional: 0, intuitivo: 0 };

    timelines.forEach(timeline => {
      const posicao = idade % timeline.length;
      const letra = timeline[posicao];
      const plano = descobrirPlano(letra);
      const valor = calcularValorComAcentos(letra);

      if (plano === "fisico") soma.fisico += valor;
      if (plano === "mental") soma.mental += valor;
      if (plano === "emocional") soma.emocional += valor;
      if (plano === "intuitivo") soma.intuitivo += valor;
    });

    bancoMomentos.push({ 
      ano: anoInicio, 
      intervalo: intervaloData, 
      ...soma 
    });
  }

  preencherSeletorAnos();
}

function preencherSeletorAnos(){
 const select=document.getElementById("anoSelect");
 select.innerHTML="";

 bancoMomentos.forEach(a=>{
   select.innerHTML+=`<option value="${a.ano}">${a.ano}</option>`;
 });

 // ‚≠ê ESSENCIAL ‚Äî selecionar automaticamente o primeiro ano
 if(bancoMomentos.length > 0){
   select.value = bancoMomentos[0].ano;
 }
}


  // Fun√ß√£o que estava faltando e causando erro no seu console
function classificarIntensidade(valor, maior) {
    if (valor >= maior * 0.75) return "forte";
    if (valor >= maior * 0.5) return "medio";
    return "fraco";
}
//================ STATUS DO MOMENTO (NOVO MOTOR)

function gerarStatusMomento() {
    const anoSelecionado = document.getElementById("anoSelect").value;
    if (!anoSelecionado) return;

    const dados = bancoMomentos.find(a => a.ano == anoSelecionado);
    if (!dados) return;

    const maiorBruto = Math.max(dados.fisico, dados.mental, dados.emocional, dados.intuitivo);

    const reducoes = {
        fisico: reduzirNumero(dados.fisico),
        mental: reduzirNumero(dados.mental),
        emocional: reduzirNumero(dados.emocional),
        intuitivo: reduzirNumero(dados.intuitivo)
    };

    // Atualiza as barras
    atualizarBarraNatural("Fisico", dados.fisico, maiorBruto, reducoes.fisico);
    atualizarBarraNatural("Mental", dados.mental, maiorBruto, reducoes.mental);
    atualizarBarraNatural("Emocional", dados.emocional, maiorBruto, reducoes.emocional);
    atualizarBarraNatural("Intuitivo", dados.intuitivo, maiorBruto, reducoes.intuitivo);

    const dadosTextoMomento = {
        fisico: { nivel: classificarIntensidade(dados.fisico, maiorBruto), numero: reducoes.fisico },
        mental: { nivel: classificarIntensidade(dados.mental, maiorBruto), numero: reducoes.mental },
        emocional: { nivel: classificarIntensidade(dados.emocional, maiorBruto), numero: reducoes.emocional },
        intuitivo: { nivel: classificarIntensidade(dados.intuitivo, maiorBruto), numero: reducoes.intuitivo }
    };

    const textoBase = gerarTextoPlano("momento", dadosTextoMomento);

    // Exibe o texto na tela
    const campoTexto = document.getElementById("resumoMomento");
    campoTexto.innerText = 
        "No ano de " + anoSelecionado + " (" + dados.intervalo + "):\n\n" + 
        "Voc√™ estar√° vivendo a seguinte express√£o:\n\n" + textoBase;
    
    campoTexto.style.display = "block";

 // L√≥gica para pegar as letras que regem o ano atual
    const anoRef = parseInt(anoSelecionado);
    const nasc = new Date(document.getElementById("dataNascimento").value).getFullYear();
    const idadeRef = anoRef - nasc;
    let letrasMom = [];
    nome.toUpperCase().split(/\s+/).forEach(p => {
        if(p.length > 0) letrasMom.push(p[idadeRef % p.length]);
    });
    atualizarTabela3(letrasMom, "Mom"); 
} // FECHAMENTO DA FUN√á√ÉO

function atualizarBarra(tipo,valor,maior){
 let largura=0;

 if(maior>0 && valor>0){
   largura=(valor/maior)*100;
   if(largura<12) largura=12;
 }

 document.getElementById("bar"+tipo).style.width=largura+"%";
 document.getElementById("txt"+tipo).innerText=valor;
}



function atualizarBarraNatural(tipo, valorBruto, maiorBruto, reducao) {
    let largura = 0;

    // A intensidade (tamanho) usa o valor total das letras (ex: 13)
    if (maiorBruto > 0 && valorBruto > 0) {
        largura = (valorBruto / maiorBruto) * 100;
        if (largura < 12) largura = 12; // Mant√©m o padr√£o do seu CSS
    }

    // 1. Ajusta a largura da barra colorida (fisico, mental, etc)
    const elementoBarra = document.getElementById("bar" + tipo);
    if (elementoBarra) {
        elementoBarra.style.width = largura + "%";
    }
    
    // 2. Coloca apenas o n√∫mero REDUZIDO (ex: 4) no span ao lado do t√≠tulo
    const spanNumero = document.getElementById("num" + tipo);
    if (spanNumero) {
        spanNumero.innerText = reducao;
    }
}
// =======================
// BOT√ÉO PRINCIPAL
// =======================
function gerarTudo(){

  const nome = document.getElementById("nome").value;
  const data = document.getElementById("dataNascimento").value;

  if(!nome || !data){
    alert("Digite nome e data.");
    return;
  }
function calcularPerfilExpressao(nome) {
    let contagem = { criativo: 0, indeciso: 0, neutro: 0 };
    
    // Limpa o nome (remove espa√ßos e acentos para bater com a tabela)
    const nomeLimpo = nome.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");

    for (let letra of nomeLimpo) {
        const tipo = tabelaExpressao[letra];
        if (tipo) {
            contagem[tipo]++;
        }
    }

    // C√°lculo de porcentagem para facilitar a exibi√ß√£o futura
    const total = contagem.criativo + contagem.indeciso + contagem.neutro;
    const porcentagens = {
        criativo: total > 0 ? Math.round((contagem.criativo / total) * 100) : 0,
        indeciso: total > 0 ? Math.round((contagem.indeciso / total) * 100) : 0,
        neutro: total > 0 ? Math.round((contagem.neutro / total) * 100) : 0
    };

    return { contagem, porcentagens };
}
  // gera plano natural
  planoNatural(nome);

  // gera timeline do momento
  planoMomento(nome, data);

  // j√° calcula automaticamente o primeiro status
  gerarStatusMomento();

}

//================ EXPORTAR PARA RELAT√ìRIO PREMIUM
function exportarRelatorio(){

 const nome = document.getElementById("nome").value;
 const data = document.getElementById("dataNascimento").value;
 const anoSelecionado = document.getElementById("anoSelect").value;

 if(!nome || !data || bancoMomentos.length === 0){
   alert("Gere o mapa antes de exportar o relat√≥rio.");
   return;
 }

 // pega dados do plano natural direto das barras
// pega n√∫meros REAIS do plano natural (sem texto da tela)
const natural = {
  fisico: resultadoPlanosNatural.fisico.numero === undefined ? 0 : 
          resultadoPlanosNatural.fisico.numero, // n√£o usado no gr√°fico, mas mantido

  mental: resultadoPlanosNatural.mental.numero === undefined ? 0 :
          resultadoPlanosNatural.mental.numero,

  emocional: resultadoPlanosNatural.emocional.numero === undefined ? 0 :
             resultadoPlanosNatural.emocional.numero,

  intuitivo: resultadoPlanosNatural.intuitivo.numero === undefined ? 0 :
             resultadoPlanosNatural.intuitivo.numero
};

 // pega dados do ano escolhido
 const dadosAno = bancoMomentos.find(a => a.ano == anoSelecionado);

 const momento = {
   ano: anoSelecionado,
   fisico: dadosAno.fisico,
   mental: dadosAno.mental,
   emocional: dadosAno.emocional,
   intuitivo: dadosAno.intuitivo
 };

const pacoteRelatorio = {
  nome: nome,
  data: data,
  natural: natural,
  momento: momento,
anoMomento: anoSelecionado,
  // valores dos planos naturais (das barras)
// üî• AGORA ENVIANDO OS N√öMEROS CORRETOS
fisico: valoresBrutosNatural.fisico,
mental: valoresBrutosNatural.mental,
emocional: valoresBrutosNatural.emocional,
intuitivo: valoresBrutosNatural.intuitivo,
// üîµ VALORES BRUTOS DO MOMENTO (NOVO)
fisicoMomento: dadosAno.fisico,
mentalMomento: dadosAno.mental,
emocionalMomento: dadosAno.emocional,
intuitivoMomento: dadosAno.intuitivo,
  // textos completos j√° gerados na tela
  textoNatural: document.getElementById("resumoNatural").innerText,
  textoMomento: document.getElementById("resumoMomento").innerText
};

  


 // salva no navegador
 localStorage.setItem("relatorioMapa", JSON.stringify(pacoteRelatorio));

 // abre p√°gina premium
 window.open("https://hemricciinstintosuperior-rcci.github.io/app-plano-de-expressao/premium.html", "_blank");
}
</script>


<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}
 // üîí BLOQUEIO C√ìPIA
// =======================
document.oncontextmenu=()=>false;
document.onselectstart=()=>false; 

</script>
</body>
</html>
