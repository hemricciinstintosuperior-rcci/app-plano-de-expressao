<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Relatório Premium - Plano de Expressão</title>
<style>
/* CONFIGURAÇÃO BASE - FUNDO BRANCO TOTAL */
body { font-family: "Times New Roman", serif; color:#000; background:#ffffff; line-height:1.6; margin:0; padding: 0; }
#conteudo { width: 100%; max-width: 800px; margin: 0 auto; padding: 20px; }

/* CAPA */
.capa { text-align:center; padding: 100px 20px; page-break-after: always; background: #fff; }
.logo { max-width:250px; margin-bottom:40px; }
.nomeCliente { font-size: 32px; font-weight: bold; margin-bottom: 10px; text-transform: uppercase; }
.subtitulo { font-size: 24px; color: #191F42; font-style: italic; }

/* SEÇÕES SEM BLOCOS CINZAS */
.secao { page-break-inside: avoid; background: transparent; padding: 20px 0; margin-top: 30px; border-bottom: 1px solid #eee; }
h2 { font-size: 26px; color: #111; margin-bottom: 20px; border-left: 5px solid #191F42; padding-left: 15px; }
h3 { font-size: 22px; color: #333; }

/* ESTILOS DAS BARRAS - SEM NÚMEROS */
.barra { margin: 15px 0; page-break-inside: avoid; }
.barra span { font-weight: bold; display: block; margin-bottom: 5px; font-size: 16px; color: #000 !important; }
.linha { width: 100%; height: 12px; background: #eeeeee !important; border-radius: 10px; overflow: hidden; -webkit-print-color-adjust: exact; }
.preenchimento { display: block; height: 100%; border-radius: 10px; -webkit-print-color-adjust: exact; box-shadow: inset 0 0 0 1000px; }

/* CORES DAS BARRAS */
.fisico { background-color: #ef4444 !important; box-shadow: inset 0 0 0 1000px #ef4444 !important; }
.mental { background-color: #06b6d4 !important; box-shadow: inset 0 0 0 1000px #06b6d4 !important; }
.emocional { background-color: #22c55e !important; box-shadow: inset 0 0 0 1000px #22c55e !important; }
.intuitivo { background-color: #eab308 !important; box-shadow: inset 0 0 0 1000px #eab308 !important; }
.criativo { background-color: #a855f7 !important; box-shadow: inset 0 0 0 1000px #a855f7 !important; }
.indeciso { background-color: #f97316 !important; box-shadow: inset 0 0 0 1000px #f97316 !important; }
.neutro { background-color: #94a3b8 !important; box-shadow: inset 0 0 0 1000px #94a3b8 !important; }

/* TEXTOS E SÍNTESE */
.texto-grande { margin-top: 15px; padding: 15px; border-left: 4px solid #a855f7; font-style: italic; background: #fff; color: #333; font-size: 15px; }
p { text-align: justify; font-size: 16px; color: #222; }
.rodape { margin-top: 50px; text-align: center; font-size: 12px; color: #999; border-top: 1px solid #eee; padding-top: 10px; }

/* BLOCAGEM DE TRÂNSITO */
.box-transito { border: 2px solid #ffd633; padding: 20px; border-radius: 10px; margin-top: 20px; }

@media print {
    body { background: #fff; }
    .secao { border-bottom: 1px solid #eee; }
}
</style>
</head>
<body>

<div id="conteudo">Carregando relatório premium...</div>

<script>
const dadosSalvos = localStorage.getItem("relatorioMapa");
if(!dadosSalvos){
    document.getElementById("conteudo").innerHTML = "<h2>Erro: Nenhum mapa encontrado.</h2>";
} else {
    const rel = JSON.parse(dadosSalvos);
    const dataBr = rel.data.split('-').reverse().join('/');

    // Cálculos de Proporção
    const maxNat = Math.max(rel.fisico, rel.mental, rel.emocional, rel.intuitivo);
    const maxExpNat = Math.max(rel.criativoNat, rel.indecisoNat, rel.neutroNat);
    const maxMom = Math.max(rel.fisicoMomento, rel.mentalMomento, rel.emocionalMomento, rel.intuitivoMomento);
    const maxExpMom = Math.max(rel.criativoMom, rel.indecisoMom, rel.neutroMom);

    document.getElementById("conteudo").innerHTML = `
        <div class="capa">
            <img class="logo" src="https://raw.githubusercontent.com/hemricciinstintosuperior-rcci/app-plano-de-expressao/main/icon-192.png">
            <div class="nomeCliente">${rel.nome}</div>
            <div class="subtitulo">${dataBr}</div>
            <p style="text-align:center; margin-top:20px;">Relatório Numerológico Quântico</p>
        </div>

        <div class="secao">
            <h2>1. Perfil de Expressão Natural</h2>
            <p>O Perfil Natural descreve sua essência primária e como você se posiciona diante do mundo de forma instintiva.</p>
            <div class="grafico">
                ${gerarBarra("Criativo", rel.criativoNat, maxExpNat, 'criativo')}
                ${gerarBarra("Indeciso", rel.indecisoNat, maxExpNat, 'indeciso')}
                ${gerarBarra("Neutro", rel.neutroNat, maxExpNat, 'neutro')}
            </div>
            <div class="texto-grande">${rel.textoExpressaoNat}</div>
        </div>

        <div class="secao">
            <h2>2. Plano de Expressão Natural</h2>
            <p>As ferramentas estruturais da sua alma: como sua inteligência, ação e emoção operam de forma permanente.</p>
            <div class="grafico">
                ${gerarBarra("Físico", rel.fisico, maxNat, 'fisico')}
                ${gerarBarra("Mental", rel.mental, maxNat, 'mental')}
                ${gerarBarra("Emocional", rel.emocional, maxNat, 'emocional')}
                ${gerarBarra("Intuitivo", rel.intuitivo, maxNat, 'intuitivo')}
            </div>
            <div style="white-space:pre-line; margin-top:20px;">${rel.textoNatural}</div>
        </div>

        <div class="secao">
            <h2>3. Vibração de Trânsito (Ano ${rel.anoMomento})</h2>
            <p>A energia predominante que regerá suas decisões e o fluxo dos acontecimentos neste ciclo específico.</p>
            <div class="box-transito">
                ${rel.transitoHTML || "Trânsito não calculado."}
            </div>
        </div>

        <div class="secao">
            <h2>4. Status do Momento (Ciclo Atual)</h2>
            <p>As energias que estão sendo mais exigidas de você agora para manter o equilíbrio.</p>
            <div class="grafico">
                ${gerarBarra("Físico", rel.fisicoMomento, maxMom, 'fisico')}
                ${gerarBarra("Mental", rel.mentalMomento, maxMom, 'mental')}
                ${gerarBarra("Emocional", rel.emocionalMomento, maxMom, 'emocional')}
                ${gerarBarra("Intuitivo", rel.intuitivoMomento, maxMom, 'intuitivo')}
            </div>
            <div style="white-space:pre-line; margin-top:20px;">${rel.textoMomento}</div>
        </div>

        <div class="rodape">Gerado por Instinto Superior - www.instintosuperior.com</div>
    `;

    setTimeout(() => { window.print(); }, 1500);
}

function gerarBarra(label, valor, maior, classe) {
    let pct = maior > 0 ? Math.max((valor / maior) * 100, 8) : 0;
    return `
        <div class="barra">
            <span>${label}</span>
            <div class="linha">
                <div class="preenchimento ${classe}" style="width:${pct}%;"></div>
            </div>
        </div>`;
}
</script>
</body>
</html>
